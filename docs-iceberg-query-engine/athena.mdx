---
title: AWS Athena
description: Serverless interactive analytics service for querying Iceberg tables in S3
---

import { QueryEngineLayout } from '@site/src/components/Iceberg/QueryEngineLayout';
import { 
  CloudIcon,
  ServerIcon,
  ClockIcon,
  ShieldCheckIcon,
  CurrencyDollarIcon,
  ChartBarIcon
} from '@heroicons/react/24/outline';

export const athenaFeatures = [
  {
    title: "Serverless Architecture",
    chip: "No Infrastructure",
    description: "Zero infrastructure management with automatic scaling and pay-per-query pricing",
    icon: <CloudIcon className="w-6 h-6" />,
    color: "blue",
    details: {
      title: "Serverless Analytics with Athena",
      description: "AWS Athena eliminates the need for infrastructure provisioning, making it ideal for ad-hoc analytics and intermittent workloads.",
      sections: [
        {
          heading: "Key Benefits",
          content: "Athena's serverless model provides instant query capability without cluster management.",
          subsections: [
            {
              title: "Automatic Scaling",
              content: "Queries automatically scale based on data size and complexity, with no manual intervention required."
            },
            {
              title: "Pay-per-Query",
              content: "You only pay for the data scanned by your queries, making it cost-effective for sporadic usage.",
              codeExample: `-- Cost optimization with partition pruning
SELECT * FROM iceberg_table
WHERE year = 2024 AND month = 1
-- Only scans relevant partitions, reducing cost`
            },
            {
              title: "Instant Availability",
              content: "Start querying immediately without waiting for cluster provisioning or warm-up time."
            }
          ]
        }
      ],
      externalLinks: [
        { label: "Athena Pricing", url: "https://aws.amazon.com/athena/pricing/" },
        { label: "Performance Tuning", url: "https://docs.aws.amazon.com/athena/latest/ug/performance-tuning.html" }
      ]
    }
  },
  {
    title: "Native AWS Integration",
    chip: "Seamless",
    description: "Deep integration with AWS services including Glue, S3, IAM, and Lake Formation",
    icon: <ServerIcon className="w-6 h-6" />,
    color: "green",
    details: {
      title: "AWS Ecosystem Integration",
      description: "Athena seamlessly integrates with the entire AWS analytics stack for a unified experience.",
      sections: [
        {
          heading: "Glue Data Catalog",
          content: "Automatic integration with AWS Glue for centralized metadata management.",
          subsections: [
            {
              title: "Automatic Schema Discovery",
              content: "Glue crawlers can automatically discover and catalog Iceberg tables in S3."
            },
            {
              title: "Shared Metadata",
              content: "Tables registered in Glue are immediately available to all AWS analytics services."
            }
          ]
        },
        {
          heading: "S3 Integration",
          content: "Direct querying of Iceberg tables stored in S3 with optimized performance.",
          subsections: [
            {
              title: "S3 Select Pushdown",
              content: "Athena pushes filters to S3 when possible to minimize data transfer."
            }
          ]
        }
      ],
      externalLinks: [
        { label: "AWS Glue Integration", url: "https://docs.aws.amazon.com/athena/latest/ug/glue-athena.html" }
      ]
    }
  },
  {
    title: "Time Travel Queries",
    chip: "Full Support",
    description: "Query historical versions of data using snapshot IDs or timestamps",
    icon: <ClockIcon className="w-6 h-6" />,
    color: "purple",
    details: {
      title: "Time Travel in Athena",
      description: "Access any historical version of your Iceberg tables for auditing, debugging, or analysis.",
      sections: [
        {
          heading: "Query Syntax",
          content: "Use standard SQL syntax to query historical data.",
          subsections: [
            {
              title: "Timestamp-based Queries",
              content: "Query data as it existed at a specific point in time.",
              codeExample: `SELECT * FROM iceberg_table
FOR SYSTEM_TIME AS OF TIMESTAMP '2024-01-15 10:00:00'`
            },
            {
              title: "Snapshot-based Queries",
              content: "Query specific snapshot versions for reproducible results.",
              codeExample: `SELECT * FROM iceberg_table
FOR SYSTEM_VERSION AS OF 8764321098765`
            }
          ]
        }
      ],
      externalLinks: [
        { label: "Time Travel Documentation", url: "https://docs.aws.amazon.com/athena/latest/ug/querying-iceberg-time-travel-and-version-travel-queries.html" }
      ]
    }
  },
  {
    title: "Cost Optimization",
    chip: "Built-in",
    description: "Multiple features to minimize query costs and optimize performance",
    icon: <CurrencyDollarIcon className="w-6 h-6" />,
    color: "orange",
    details: {
      title: "Cost Management in Athena",
      description: "Athena provides several mechanisms to control and optimize query costs.",
      sections: [
        {
          heading: "Query Result Reuse",
          content: "Automatically cache and reuse results from recent identical queries.",
          subsections: [
            {
              title: "Automatic Caching",
              content: "Results are cached for 24 hours and reused for identical queries at no charge."
            }
          ]
        },
        {
          heading: "Compression Benefits",
          content: "Iceberg's efficient compression reduces data scanned and costs.",
          subsections: [
            {
              title: "ZSTD Compression",
              content: "Use Zstandard compression for better compression ratios and lower costs."
            }
          ]
        }
      ],
      externalLinks: [
        { label: "Cost Control", url: "https://docs.aws.amazon.com/athena/latest/ug/cost-control.html" }
      ]
    }
  }
];

export const athenaTableData = {
  title: "AWS Athena Iceberg Feature Matrix",
  description: "Detailed breakdown of Iceberg capabilities in AWS Athena Engine v3",
  columns: [
    {
      key: "feature",
      header: "Feature",
      tooltip: "Iceberg feature or capability"
    },
    {
      key: "support",
      header: "Support Level",
      tooltip: "Level of support in Athena"
    },
    {
      key: "details",
      header: "Details",
      tooltip: "Implementation details and limitations"
    },
    {
      key: "notes",
      header: "Notes",
      tooltip: "Additional information"
    }
  ],
  rows: [
    {
      feature: { value: "Catalog Support" },
      support: { 
        value: <span className="text-yellow-600 font-semibold">Limited</span>,
        tooltip: "Only AWS Glue Data Catalog is supported"
      },
      details: { 
        value: "AWS Glue Data Catalog only; no Hive, REST, or custom catalogs"
      },
      notes: { value: "Tables must be registered in Glue" }
    },
    {
      feature: { value: "Table Formats" },
      support: { 
        value: <span className="text-green-600 font-semibold">Full</span>
      },
      details: { 
        value: "Iceberg v1 and v2 formats; Parquet, ORC, and Avro files"
      },
      notes: { value: "Parquet recommended for best performance" }
    },
    {
      feature: { value: "DML Operations" },
      support: { 
        value: <span className="text-green-600 font-semibold">Full</span>
      },
      details: { 
        value: "INSERT, UPDATE, DELETE, MERGE INTO all supported"
      },
      notes: { value: "Uses position-delete files for row-level changes" }
    },
    {
      feature: { value: "Schema Evolution" },
      support: { 
        value: <span className="text-green-600 font-semibold">Full</span>
      },
      details: { 
        value: "Add, drop, rename columns; type widening supported"
      },
      notes: { value: "All operations are metadata-only" }
    },
    {
      feature: { value: "Hidden Partitioning" },
      support: { 
        value: <span className="text-green-600 font-semibold">Full</span>
      },
      details: { 
        value: "All partition transforms supported with automatic pruning"
      },
      notes: { value: "Partition projection available for better performance" }
    },
    {
      feature: { value: "Streaming" },
      support: { 
        value: <span className="text-red-600 font-semibold">None</span>
      },
      details: { 
        value: "Batch queries only; use Kinesis Firehose for streaming ingestion"
      },
      notes: { value: "Can query tables updated by streaming systems" }
    },
    {
      feature: { value: "Format V3" },
      support: { 
        value: <span className="text-red-600 font-semibold">None</span>
      },
      details: { 
        value: "Not supported; Engine v3 only handles spec v1/v2"
      },
      notes: { value: "V3 support on roadmap" }
    }
  ]
};

export const athenaCodeExamples = [
  {
    title: "Creating Iceberg Tables",
    description: "Create and configure Iceberg tables in Athena",
    language: "sql",
    code: `-- Create an Iceberg table
CREATE TABLE my_iceberg_table (
  id bigint,
  name string,
  event_time timestamp,
  amount decimal(10,2)
)
LOCATION 's3://my-bucket/iceberg-data/my_table'
TBLPROPERTIES (
  'table_type' = 'ICEBERG',
  'format' = 'parquet',
  'write_compression' = 'snappy',
  'optimize_rewrite_delete_file_threshold' = '10'
);

-- Create partitioned table
CREATE TABLE events_partitioned (
  event_id bigint,
  event_time timestamp,
  user_id string,
  event_type string
)
PARTITIONED BY (day(event_time), bucket(16, user_id))
LOCATION 's3://my-bucket/iceberg-data/events'
TBLPROPERTIES ('table_type' = 'ICEBERG');

-- Create table from query (CTAS)
CREATE TABLE summary_table
WITH (
  table_type = 'ICEBERG',
  location = 's3://my-bucket/iceberg-data/summary',
  is_external = false
)
AS SELECT 
  date_trunc('hour', event_time) as hour,
  count(*) as event_count,
  sum(amount) as total_amount
FROM source_table
GROUP BY 1;`
  },
  {
    title: "DML Operations",
    description: "Data manipulation with MERGE, UPDATE, and DELETE",
    language: "sql",
    code: `-- MERGE operation for upserts
MERGE INTO target_table t
USING source_table s
ON t.id = s.id
WHEN MATCHED THEN
  UPDATE SET
    t.name = s.name,
    t.updated_at = current_timestamp
WHEN NOT MATCHED THEN
  INSERT (id, name, created_at, updated_at)
  VALUES (s.id, s.name, current_timestamp, current_timestamp);

-- Conditional updates
UPDATE events_table
SET status = 'processed',
    processed_at = current_timestamp
WHERE status = 'pending'
  AND event_time < current_timestamp - interval '1' hour;

-- Delete old records
DELETE FROM events_table
WHERE event_time < current_timestamp - interval '90' day;

-- Complex MERGE with multiple conditions
MERGE INTO customers t
USING daily_updates s
ON t.customer_id = s.customer_id
WHEN MATCHED AND s.action = 'DELETE' THEN
  DELETE
WHEN MATCHED AND s.action = 'UPDATE' THEN
  UPDATE SET
    t.email = s.email,
    t.last_modified = s.timestamp
WHEN NOT MATCHED AND s.action = 'INSERT' THEN
  INSERT *;`
  },
  {
    title: "Performance Optimization",
    description: "Techniques for optimizing query performance and reducing costs",
    language: "sql",
    code: `-- Use partition pruning
SELECT * FROM events_table
WHERE event_time >= DATE '2024-01-01'
  AND event_time < DATE '2024-02-01';

-- Optimize file layout with VACUUM
VACUUM events_table;

-- Use projection to limit data scanned
SELECT 
  user_id,
  sum(amount) as total_spent
FROM transactions
WHERE transaction_date >= current_date - interval '7' day
GROUP BY user_id;

-- Create materialized view for repeated queries
CREATE TABLE daily_summary
WITH (table_type = 'ICEBERG')
AS 
SELECT 
  date(event_time) as event_date,
  event_type,
  count(*) as event_count,
  approx_distinct(user_id) as unique_users
FROM events_table
WHERE event_time >= current_date - interval '30' day
GROUP BY 1, 2;

-- Use ZSTD compression for better compression ratio
CREATE TABLE optimized_table (
  id bigint,
  data string
)
LOCATION 's3://bucket/optimized'
TBLPROPERTIES (
  'table_type' = 'ICEBERG',
  'write_compression' = 'ZSTD'
);`
  }
];

export const athenaUseCases = [
  {
    title: "Ad-hoc Analytics",
    description: "Perfect for exploratory data analysis and one-off queries",
    scenarios: [
      "Business intelligence queries on S3 data lakes",
      "Data exploration and discovery",
      "Quick analysis without infrastructure setup",
      "Cross-dataset joins for insights"
    ]
  },
  {
    title: "Log Analysis",
    description: "Analyze logs stored in S3 without ETL pipelines",
    scenarios: [
      "Application log analysis",
      "Security log investigation",
      "CloudTrail log queries",
      "Web server access log analytics"
    ]
  },
  {
    title: "Data Lake Queries",
    description: "Query massive datasets in S3 with SQL",
    scenarios: [
      "Query Parquet/ORC files directly",
      "Join data across multiple sources",
      "Historical data analysis",
      "Data quality validation"
    ]
  },
  {
    title: "Cost-Conscious Workloads",
    description: "Ideal for workloads where cost optimization is critical",
    scenarios: [
      "Infrequent but important queries",
      "Development and testing environments",
      "Backup data analysis",
      "Compliance and audit queries"
    ]
  }
];

<QueryEngineLayout
  title="AWS Athena"
  description="Serverless interactive analytics service for querying Iceberg tables in S3"
  features={athenaFeatures}
  tableData={athenaTableData}
  codeExamples={athenaCodeExamples}
  useCases={athenaUseCases}
  officialDocs="https://docs.aws.amazon.com/athena/latest/ug/what-is.html"
  gettingStarted="https://docs.aws.amazon.com/athena/latest/ug/getting-started.html"
  additionalResources={[
    { label: "Iceberg Tables Guide", url: "https://docs.aws.amazon.com/athena/latest/ug/querying-iceberg.html" },
    { label: "Performance Tuning", url: "https://docs.aws.amazon.com/athena/latest/ug/performance-tuning.html" },
    { label: "Cost Optimization", url: "https://aws.amazon.com/blogs/big-data/top-10-performance-tuning-tips-for-amazon-athena/" }
  ]}
/>