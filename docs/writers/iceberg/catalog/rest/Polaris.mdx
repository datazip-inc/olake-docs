---
title: Apache Polaris
description: Apache Polaris REST Catalog configuration
---

**Apache Polaris** is an Iceberg REST catalog implementation that provides table management through a REST API. It supports OAuth2 authentication, fine-grained access control, and integrates with cloud object stores like AWS S3 for metadata and data storage

### Prerequisites

Required services:
  - **Object store** – e.g., S3, MinIO, GCS, or another cloud-compatible storage for Iceberg table data and metadata.
  - **Polaris REST service** – Provides the Iceberg REST Catalog API along with built-in authentication, authorization, and management features.
  - **Identity and access management (OAuth2)** – Used by Polaris to issue and validate tokens for client authentication and role-based access.
  - **Metadata database (internal, optional)** – Polaris may use a backing database (e.g., PostgreSQL) for managing identity, tokens, and system metadata, but this is handled internally and not typically managed by the end user.

<br/>

### Configuration
<Tabs>

  <TabItem value="olake-ui" label="OLake UI" default>

    <div className='flex justify-center w-2/3 mx-auto'>
      ![Create Destination](/img/docs/iceberg/catalog/rest/rest-config.jpeg)
    </div>

    | Parameter            | Sample Value                                              | Description                                                                                   |
    |----------------------|----------------------------------------------------------|-----------------------------------------------------------------------------------------------|
    | Catalog Type         | `rest`                                                     | Defines the catalog type used by the writer.                                                  |
    | REST Catalog URL     | `http://<REST_HOSTNAME>:8181/api/catalog `            | Endpoint URL for the Polaris REST catalog service.                                            |
    | Iceberg S3 Path      | `s3://<BUCKET_NAME>`                                            | S3 path or storage location for Iceberg data.                                                 |
    | Iceberg Database     | `olake_db`                                                 | Name of the Iceberg database used by the destination configuration.                           |
    | Authentication Type  | `oauth2`                                                   | Type of authentication (e.g., "oauth2").                                                      |
    | OAuth2 URI           | `http://<REST_HOSTNAME>:8181/api/catalog/v1/oauth/tokens` | OAuth2 server URI for authentication.                                             |
    | Credential           | `<olake_user_client_id>:<olake_user_client_secret>`        | OAuth2 client ID and secret, formatted as client_id:client_secret.                            |
    | Scope                | `PRINCIPAL_ROLE:ALL`                                       | OAuth2 scopes (space-separated).                                                              |
    | AWS Region           | `ap-south-1`                                               | AWS region associated with the S3 bucket.                                                     |

  </TabItem>

  <TabItem value="olake-cli" label="OLake CLI">
    ```json title="destination.json"
    {
        "type": "ICEBERG",
        "writer": {
          "catalog_type": "rest",
          "rest_catalog_url": "http://<REST_HOSTNAME>:8181/api/catalog", 
          "iceberg_s3_path": "s3://<BUCKET_NAME>",
          "iceberg_db": "olake_db",
          "rest_auth_type": "oauth2",
          "oauth2_uri": "http://<REST_HOSTNAME>:8181/api/catalog/v1/oauth/tokens",
          "credential": "<olake_user_client_id>:<olake_user_client_secret>",
          "scope": "PRINCIPAL_ROLE:ALL",
          "aws_region": "<AWS_REGION>"
        }
    }
    ```

    #### Configuration Parameters
    | Parameter        | Sample Value                               | Description                                                                                                    |
    |------------------|--------------------------------------------|----------------------------------------------------------------------------------------------------------------|
    | catalog_type     | `rest`                                       | Defines the catalog type used by the writer. "rest" means the writer interacts with a RESTful catalog service. |
    | rest_catalog_url | `http://<REST_HOSTNAME>:8181/api/catalog`   | Specifies the endpoint URL for the Polaris REST catalog service that the writer will connect to.                |
    | iceberg_s3_path  | `s3://<BUCKET_NAME>`                        | Determines the S3 path or storage location for Iceberg data in the warehouse bucket.                           |
    | iceberg_db       | `olake_db`                                   | Specifies the name of the Iceberg database that will be used by the destination configuration.                 |
    | rest_auth_type   | `oauth2`                                     | Authentication type for Polaris REST catalog service.                                                          |
    | oauth2_uri       | `http://<REST_HOSTNAME>:8181/api/catalog/v1/oauth/tokens` | OAuth2 server URI for Polaris authentication.                                                          |
    | credential       | `<olake_user_client_id>:<olake_user_client_secret>` | OAuth2 client ID and secret, formatted as client_id:client_secret.                                    |
    | scope            | `PRINCIPAL_ROLE:ALL`                        | OAuth2 scopes for Polaris authentication.                                                                      |
    | aws_region       | `<AWS_REGION>`                              | Specifies the AWS region associated with the S3 bucket where the data is stored.                               |

  </TabItem>

</Tabs>

<br/>

### Setup Steps:

1. Save the following as `docker-compose.yml`:

```yaml
services:
  polaris:
    image: apache/polaris:latest # version on date: 22 Aug 2025
    container_name: polaris
    ports:
      - "8080:8080"    # Application port
      - "8181:8181"    # API port 
      - "8182:8182"    # Management port
      - "8443:8443"    # HTTPS port
    
    # Environment variables to fix the AWS region configuration issue
    environment:
      - AWS_REGION=ap-south-1
      
      # Optional: AWS credentials (if not using IAM roles)
      # Uncomment and set these if you're not using IAM roles for authentication
      # - AWS_ACCESS_KEY_ID=your_access_key_here
      # - AWS_SECRET_ACCESS_KEY=your_secret_key_here
    networks:
      - polaris-network

networks:
  polaris-network:
    driver: bridge
```

2. Start the services:
```bash
docker-compose up -d
```

3. Get Polaris root credentials from logs:

```bash
docker logs polaris | grep "root principal credentials"
```

Look for a line similar to:
```
realm: default-realm root principal credentials: bd0b5cde9ffb3966:9c377f72a27ba22c47e26cd53423fa96
```

Extract the credentials:
- **Client ID**: `bd0b5cde9ffb3966`
- **Client Secret**: `9c377f72a27ba22c47e26cd53423fa96`

4. Get bearer token for API requests (replace `<client_id>` and `<client_secret>` with the root credential):

```bash
curl -i -X POST \
  http://localhost:8181/api/catalog/v1/oauth/tokens \
  -d 'grant_type=client_credentials&client_id=<client_id>&client_secret=<client_secret>&scope=PRINCIPAL_ROLE:ALL'
```

5. Create S3 bucket with the following policy:

```json
{
    "Version": "2012-10-17",
    "Statement": [
        {
            "Effect": "Allow",
            "Action": [
                "s3:GetObject",
                "s3:PutObject",
                "s3:DeleteObject",
                "s3:ListBucket"
            ],
            "Resource": [
                "arn:aws:s3:::your-bucket-name",
                "arn:aws:s3:::your-bucket-name/*"
            ]
        }
    ]
}
```

6. Create IAM role for S3 access. After creating the IAM role, you'll get an ARN that looks like:
```
arn:aws:iam::############:role/olake-role
```
Copy this ARN as you'll need it in the next step.

7. Create catalog (replace `<bearer_token>` with token received in prev steps, `your-bucket-name` with your S3 bucket, and `<your-iam-role-arn>` with the ARN from step 6):

```bash
curl -i -X POST http://localhost:8181/api/management/v1/catalogs \
  -H "Authorization: Bearer <bearer_token>" \
  -H 'Accept: application/json' \
  -H 'Content-Type: application/json' \
  -d '{
    "name": "olake_catalog",
    "type": "INTERNAL",
    "properties": {
      "default-base-location": "s3://your-bucket-name"
    },
    "storageConfigInfo": {
      "storageType": "S3",
      "roleArn": "<your-iam-role-arn>",
      "allowedLocations": ["s3://your-bucket-name"]
    }
  }'
```

8. Create user and assign roles (replace `<bearer_token>` with your bearer token). The create user command's response includes the new user's client credentials.

```bash
# Create user (output includes client_id and client_secret, note them required in olake configuration)
curl -i -X POST "http://localhost:8181/api/management/v1/principals" \
  -H "Authorization: Bearer <bearer_token>" \
  -H "Content-Type: application/json" \
  -d '{"name": "olake_user", "type": "user"}'

# Create principal role
curl -i -X POST "http://localhost:8181/api/management/v1/principal-roles" \
  -H "Authorization: Bearer <bearer_token>" \
  -H "Content-Type: application/json" \
  -d '{"principalRole": {"name": "olake_user_role"}}'

# Assign role to user
curl -i -X PUT "http://localhost:8181/api/management/v1/principals/olake_user/principal-roles" \
  -H "Authorization: Bearer <bearer_token>" \
  -H "Content-Type: application/json" \
  -d '{"principalRole": {"name": "olake_user_role"}}'

# Create catalog role
curl -i -X POST "http://localhost:8181/api/management/v1/catalogs/olake_catalog/catalog-roles" \
  -H "Authorization: Bearer <bearer_token>" \
  -H "Content-Type: application/json" \
  -d '{"catalogRole": {"name": "olake_catalog_role"}}'

# Assign catalog role to principal role
curl -i -X PUT "http://localhost:8181/api/management/v1/principal-roles/olake_user_role/catalog-roles/olake_catalog" \
  -H "Authorization: Bearer <bearer_token>" \
  -H "Content-Type: application/json" \
  -d '{"catalogRole": {"name": "olake_catalog_role"}}'

# Grant privileges
curl -i -X PUT "http://localhost:8181/api/management/v1/catalogs/olake_catalog/catalog-roles/olake_catalog_role/grants" \
  -H "Authorization: Bearer <bearer_token>" \
  -H "Content-Type: application/json" \
  -d '{"grant": {"type": "catalog", "privilege": "CATALOG_MANAGE_CONTENT"}}'
```

:::note
All services involved in the sync process — including the OLake source image, Polaris, and any other dependencies — must be part of the same Docker network or accessible via network configuration.
:::

**Important Notes:**
- Use the `olake_user` credentials (not root credentials) for the final OLake configuration.
- The IAM role ARN is required for S3 access permissions.
- Ensure your AWS region matches across all configurations. 

<br/>

### Troubleshooting

- **Invalid OAuth2 credentials (401 Unauthorized)** – Ensure you’re using the olake_user client credentials, not the root credentials.
- **Verify that your client_id, client_secret, and scope match the configuration.**

- **Permission denied on S3 bucket** – Check that the IAM role ARN attached to the Polaris catalog has the correct bucket policy `(s3:GetObject, s3:PutObject, s3:DeleteObject, s3:ListBucket)`.

- **Make sure the bucket name matches exactly, including case.**

- **Connection errors to Polaris REST API** – Confirm that the Polaris REST service is running and accessible on the correct port (`default: 8181`).

- **Ensure the service is reachable from your OLake environment** (check Docker network or firewall rules if self-hosted).