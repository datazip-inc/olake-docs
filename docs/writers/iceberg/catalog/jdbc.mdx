---
title: 3. JDBC/SQL
description: JDBC/SQL Catalog configuration for OLake Apache Iceberg
sidebar_position: 3
---


# JDBC/SQL Catalog Write Guide

OLake integrates with **JDBC/SQL catalogs** (such as PostgreSQL, MySQL, etc.) to provide full support for **Apache Iceberg tables**.

With this setup:
- **Data** is stored in object storage (S3, MinIO, or any S3-compatible system).
- **Metadata** is managed in a relational database (via JDBC).
- **OLake** seamlessly writes into Iceberg tables using JDBC + object storage.

---

## Prerequisites

Before configuring OLake with JDBC Catalog, ensure the following:

#### 1. Relational Database

- A JDBC-supported database (such as PostgreSQL or MySQL) will serve as the Iceberg metadata catalog.

#### Required Database Permissions

The JDBC catalog user must have sufficient privileges to manage Iceberg metadata tables. OLake requires the following database permissions:

> **CREATE TABLE** - Creates Iceberg catalog metadata tables (`iceberg_tables`, `iceberg_namespace_properties`, etc.) on first connection
>
> **INSERT** - Adds new table metadata entries, namespace registrations, and commit history records to catalog tables
>
> **UPDATE** - Modifies existing table metadata during schema evolution, partition updates, and table property changes
>
> **DELETE** - Removes obsolete metadata entries when tables are dropped or during catalog maintenance operations
>
> **SELECT** - Reads metadata for table discovery, schema validation, and query planning operations

:::info Database Setup
For detailed database-specific setup instructions and advanced permission configurations, refer to the [**Apache Iceberg JDBC Catalog documentation**](https://iceberg.apache.org/docs/latest/jdbc/).
:::

#### 2. Object Storage

- A bucket for storing **Iceberg data files (Parquet + metadata)**.

---

## Configuration

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';
import MinioJDBCIcebergWriterUIConfigLocalDetailsOLakeUI from '@site/docs/shared/config/MinioJDBCIcebergWriterUIConfigLocalDetailsOLakeUI.mdx';
import MinioJDBCIcebergWriterUIConfigLocalDetailsOLakeCLI from '@site/docs/shared/config/MinioJDBCIcebergWriterUIConfigLocalDetailsOLakeCLI.mdx';

<Tabs>
<TabItem value="jdbc-ui" label="OLake UI" default>

After setting up the source, configure your **destination with JDBC Catalog**.

<div style={{textAlign: 'center'}}>

![JDBC Catalog OLake UI Configuration](/img/docs/iceberg/jdbc/jdbc-catalog-olake-ui-setup-destination.png)

</div>

<MinioJDBCIcebergWriterUIConfigLocalDetailsOLakeUI/>

**Click `Next →`** to test the connection. OLake will verify JDBC + object storage connectivity.

</TabItem>

<TabItem value="jdbc-cli" label="OLake CLI">

Create a `destination.json` with the following configuration:

```json title="destination.json"
{
     "type": "ICEBERG",
     "writer": {
          "catalog_type": "jdbc",
          "jdbc_url": "jdbc:postgresql://host.docker.internal:5432/iceberg",
          "jdbc_username": "iceberg",
          "jdbc_password": "password",
          "iceberg_s3_path": "s3a://warehouse",
          "s3_endpoint": "http://host.docker.internal:9000",
          "s3_use_ssl": false,
          "s3_path_style": true,
          "aws_access_key": "admin",
          "aws_region": "us-east-1",
          "aws_secret_key": "password",
          "iceberg_db": "iceberg_db"
     }
}
```

<MinioJDBCIcebergWriterUIConfigLocalDetailsOLakeCLI/>

Run the sync command using this `destination.json`.

</TabItem>
</Tabs>

:::tip Connection Testing
OLake automatically validates:

* JDBC connectivity & authentication
* Object storage access (S3/MinIO)
* Database creation & access permissions
:::

---

#### Local Development Setup

Here's an example `docker-compose.yml` for OLake with **PostgreSQL JDBC Catalog + MinIO**:

```yml
version: "3.9"

services:
  postgres:
    image: postgres:15
    container_name: iceberg-postgres
    environment:
      POSTGRES_USER: iceberg
      POSTGRES_PASSWORD: password
      POSTGRES_DB: iceberg
    ports:
      - "5432:5432"
    healthcheck:
      test: ["CMD", "pg_isready", "-U", "iceberg", "-d", "iceberg"]
      interval: 2s
      timeout: 10s
      retries: 5
      start_period: 10s
    volumes:
      - ./data/postgres-data:/var/lib/postgresql/data
    networks:
      - iceberg_net

  minio:
    image: minio/minio:RELEASE.2025-04-03T14-56-28Z
    container_name: minio
    environment:
      - MINIO_ROOT_USER=admin
      - MINIO_ROOT_PASSWORD=password
      - MINIO_DOMAIN=minio
    networks:
      iceberg_net:
        aliases:
          - warehouse.minio
    ports:
      - 9001:9001
      - 9000:9000
    volumes:
      - ./data/minio-data:/data
    command: [ "server", "/data", "--console-address", ":9001" ]

  mc:
    depends_on:
      - minio
    image: minio/mc:RELEASE.2025-04-03T17-07-56Z
    container_name: mc
    networks:
      iceberg_net:
    environment:
      - AWS_ACCESS_KEY_ID=admin
      - AWS_SECRET_ACCESS_KEY=password
      - AWS_REGION=us-east-1
    entrypoint: |
      /bin/sh -c "
      until (/usr/bin/mc config host add minio http://minio:9000 admin password) do echo '...waiting...' && sleep 1; done;
      if ! /usr/bin/mc ls minio/warehouse > /dev/null 2>&1; then
        /usr/bin/mc mb minio/warehouse;
        /usr/bin/mc policy set public minio/warehouse;
      fi;
      tail -f /dev/null
      "

networks:
  iceberg_net:
    name: iceberg_net

volumes:
  postgres-data:
  minio-data:
```

---

## Troubleshooting

### Common Errors & Solutions

| Error | Cause | Resolution |
|-------|-------|------------|
| `Connection refused to host:port` | JDBC database not accessible | • Verify database is running and accessible<br/>• Check `jdbc_url` format and port<br/>• Use `host.docker.internal` instead of `localhost` in Docker<br/>• Ensure database accepts connections from OLake's IP |
| `Authentication failed for user` | Invalid database credentials | • Verify `jdbc_username` and `jdbc_password`<br/>• Ensure user exists in the database<br/>• Check user has required permissions (CREATE, INSERT, UPDATE, DELETE, SELECT) |
| `SSL connection error` | SSL/TLS configuration mismatch | • For S3: Ensure `s3_use_ssl` matches endpoint protocol (http/https)<br/>• For JDBC: Add `?sslmode=disable` to jdbc_url for non-SSL databases |
| `Access Denied` or `Forbidden` S3 error | Invalid S3 credentials or permissions | • Verify `aws_access_key` and `aws_secret_key`<br/>• Ensure S3 bucket exists and is accessible<br/>• Check bucket permissions allow read/write operations |
| `NoSuchBucket` error | S3 bucket doesn't exist | • Create the bucket specified in `iceberg_s3_path`<br/>• Verify bucket name matches exactly (case-sensitive)<br/>• Ensure bucket is in the correct region |
| `Table already exists` error | Iceberg metadata table conflicts | • Drop existing tables if safe to do so<br/>• Use different `iceberg_db` name<br/>• Clear existing metadata tables manually |
| `Path style access` error | S3 addressing configuration issue | • Set `s3_path_style: true` for MinIO and non-AWS S3<br/>• Use correct endpoint format without bucket name |
| `Region mismatch` error | S3 region configuration issue | • Ensure `aws_region` matches your S3 bucket region<br/>• For MinIO, use any valid region (e.g., `us-east-1`) |

---

### Debugging Checklist

1. **Check DB connectivity**

   ```bash
   psql -h <postgres-host> -p <port> -U <username> -d <database>
   ```

2. **Verify Object Storage access**

   ```bash
   docker exec -it <minio-container> /bin/sh
   mc alias set <alias-name> http://<minio-host>:<minio-port> <access-key> <secret-key>
   mc ls <alias-name>
   ```
