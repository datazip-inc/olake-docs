---
title: Postgres
description: OLake Postgres Connector documentation
sidebar_position: 2
---

## Postgres Connector
OLake supports data ingestion from Postgres as a source. The connector can be configured using either the OLake UI or the OLake CLI.

<Tabs>

<TabItem value="olake-ui" label="OLake UI" default>
## Setup Prerequisites
- Postgres instance available with valid credentials  
- OLake UI installed <!-- TODO: Add OLake UI install page link -->
- To setup Postgresql, follow the appropriate setup guide for your postgres environment:
    - [Aurora Postgres               – CDC Setup Guide](/docs/connectors/postgres/setup/aurora.mdx)
    - [Amazon RDS Postgres           – CDC Setup Guide](/docs/connectors/postgres/setup/rds.mdx)
    - [Postgres via Docker Compose   – Local Setup](/docs/connectors/postgres/setup/local.mdx)
    - [Azure Database for Postgres   – CDC Setup Guide](/docs/connectors/postgres/setup/azure.mdx)
    - [Google Cloud SQL for Postgres – CDC Setup Guide](/docs/connectors/postgres/setup/gcp.mdx)
    - [Generic Postgres              – CDC Setup Guide](/docs/connectors/postgres/setup/generic.mdx)

---

## Configuration

**1. Navigate to the Sources Page**  
Log in to OLake UI. The default credentials are:  
- **Username**: `admin`  
- **Password**: `password`  

Select the `Sources` tab from the left sidebar.
    <div style={{textAlign: 'center'}}>
    ![Source tab](/img/docs/sources/navigate-to-source.gif)
    </div>

**2. Create Postgres Source**  
1. Click **Create Source** on the top right corner.  
2. Select **Postgres** from the connector dropdown and provide a name for this source.  
    <div style={{textAlign: 'center'}}>
    ![Source tab](/img/docs/sources/postgres/create-postgres-src.gif)
    </div>
3. Enter Postgres credentials.  
   <div className="flex justify-center w-full">
    <div className="w-3/5">
    ![Source tab](/img/docs/sources/postgres/postgres-config.png)
    </div>
    </div>
    
| Field                                                 | Description                                                                               | Example Value                  | Data Type |
|-------------------------------------------------------|-------------------------------------------------------------------------------------------|--------------------------------|-----------|
| Postgres Host<span className="text-red-500">*</span>  | Hostname or IP address of the Postgres database server.                                   | `"pg-host"`                    | String    |
| Postgres Port<span className= "text-red-500">*</span> | TCP port on which the Postgres listener is accepting connections.                         | `5432`                         | Integer   |
| Database Name<span className= "text-red-500">*</span> | The name of the target database to connect to.                                            | `"olake-db"`                   | String    |
| Password<span className= "text-red-500">*</span>      | The password corresponding to the provided username for authentication.                   | `"pgpwd"`                      | String    |
| Username<span className= "text-red-500">*</span>      | Database user used to authenticate the connection.                                        | `"pg-user"`                    | String    |
| Initial Wait Time                                     | Idle timeout for WAL log reading                                                          | `120`                          | Integer   |
| Max Threads                                           | Maximum number of worker threads the connector can spin up for parallel tasks.            | `10`                           | Integer   |
| Replication Slot                                      | Slot to retain WAL logs for consistent replication.                                       | `"olake-repl-slot"`            | String    |
| JDBC URL Parameters                                   | Extra JDBC URL parameters for fine-tuning the connection (left empty if none are needed). | `{"test-param": "test-value"}` | Object    |
| SSL Mode                                              | SSL configuration for the database connection. Contains details such as the SSL mode.     | `{"mode": "disable"}`          | Object    |

<span className= "text-red-500">*</span>  Required fields <br/>

   4. Once the connection is validated, the Postgres source is created. Jobs can then be configured using this source.  
    <div className="flex justify-center w-full">
    <div className="w-2/5">
        ![Source tab](/img/docs/sources/postgres/source-created.png)
        </div>
        </div>

### Postgres to Iceberg Datatype mapping

<PostgresToIcebergDatatypes/>


---

## Troubleshooting
### 1. No encryption (SQLSTATE 28000)
```logs
FATAL failed to ping database: failed to connect to `host=product-team-testing.postgres.database.azure.com user=product_team database=postgres`: server error (FATAL: no p
g_hba.conf entry for host "4.240.65.100", user "product_team", database "postgres", no encryption (SQLSTATE 28000))
```

**Solution**: Change the `ssl.mode`: `disable` to `ssl.mode`: `allow` to resolve this issue. This is a known issue with Azure Postgres and the solution is to set the `ssl.mode` to `allow` in the connection string. 


#### Unexpected EOF
Running Postgres Sync ran into following error: FATAL error occurred while reading records: failed to receive message from wal: receive message failed: unexpected EOF -
**Solution**: Set the value of `initial_wait_time`: 10 in case if you have increased the value in source database config file. This could be because of network issues, try again in that case.


### 2.Connecting to Supbase

OLake can connect seamlessly to [Supabase](https://supabase.com) Postgres databases using any of the three connection modes that Supabase provides:

- **Direct Connection** – Connects directly to the Postgres instance.  
  _Note: By default, Supabase's direct connection supports only **IPv6**. IPv4 support can be enabled via the paid IPv4 add-on._

- **Transaction Pooler** – Uses PgBouncer in transaction pooling mode. Suitable for most use cases that do not require session-level features.

- **Session Pooler** – Recommended when the client network supports only IPv4. In this mode, each client gets a dedicated database session.

> ⚠️ **CDC Support**: The Direct Connection mode is required for CDC (Change Data Capture) operations, as Supabase permits replication slot creation only when connecting directly to the Postgres instance.

#### IP Version Compatibility

OLake fully supports both **IPv4 and IPv6** connections. However, Supabase’s IP compatibility depends on the connection mode and account configuration.

To check your machine or cloud environment’s IP version, you can run:
```bash
curl -6 https://ifconfig.co/ip
```
The format of the returned address indicates the IP version:

- Addresses with four decimal numbers (0–255) separated by dots (.), for eg. `192.168.1.1`, indicate **IPv4**.
- Addresses containing hexadecimal segments separated by colons (:), such as `2404:6800:4007:821::200e`, indicate **IPv6**.

#### Docker IPv6 Support
By default, Docker containers support only IPv4, which may block access to Supabase’s Direct Connection if IPv6 is required. IPv6 can be enabled as follows:

1. Open the **Docker Desktop Dashboard**.
2. Click the **Settings** icon (⚙️) in the top-right corner.
3. Select **Docker Engine** from the left-hand sidebar.
4. In the JSON configuration editor, add the following line

```json
"ipv6":true
```

5. Click Apply & Restart to save the changes and restart Docker.

#### RLS (Row-Level Security) Considerations

When using a read-only database role for syncing with OLake, ensure that **Row-Level Security (RLS)** is either disabled or properly configured. If RLS policies restrict access, sync operations may complete without error but result in **zero rows being replicated**.

To allow a specific role to bypass RLS entirely, execute the following command (replace `<rolename>` with the actual role name):

```sql
ALTER USER <rolename> WITH BYPASSRLS;
```


</TabItem>



<TabItem value="olake-cli" label="OLake CLI" default>

## Setup Prerequisites
- Postgres instance available with valid credentials
- OLake CLI installed via Docker or Binary <!-- TODO: Add OLake CLI install page links -->
- To setup Postgresql, follow the appropriate setup guide for your postgres environment:
    - [Aurora Postgres               – CDC Setup Guide](/docs/connectors/postgres/setup/aurora.mdx)
    - [Amazon RDS Postgres           – CDC Setup Guide](/docs/connectors/postgres/setup/rds.mdx)
    - [Postgres via Docker Compose   – Local Setup](/docs/connectors/postgres/setup/local.mdx)
    - [Azure Database for Postgres   – CDC Setup Guide](/docs/connectors/postgres/setup/azure.mdx)
    - [Google Cloud SQL for Postgres – CDC Setup Guide](/docs/connectors/postgres/setup/gcp.mdx)
    - [Generic Postgres              – CDC Setup Guide](/docs/connectors/postgres/setup/generic.mdx)
---

## Configuration

### 1. Create Configuration Files
    - Once the Olake CLI is setup, create a folder to store configuration files such as `source.json` and `destination.json`.
    
    The `source.json` file for postgres must contain these mandatory fields.
    <PostgresSourceConfig/>

| Field                                            | Description                                                                               | Example Value                  | Data Type |
|--------------------------------------------------|-------------------------------------------------------------------------------------------|--------------------------------|-----------|
| host<span className="text-red-500">*</span>      | Hostname or IP address of the Postgres database server.                                   | `"pg-host"`                    | String    |
| port<span className= "text-red-500">*</span>     | TCP port on which the Postgres listener is accepting connections.                         | `5432`                         | Integer   |
| database<span className= "text-red-500">*</span> | The name of the target database to connect to.                                            | `"olake-db"`                   | String    |
| password<span className= "text-red-500">*</span> | The password corresponding to the provided username for authentication.                   | `"pgpwd"`                      | String    |
| username<span className= "text-red-500">*</span> | Database user used to authenticate the connection.                                        | `"pg-user"`                    | String    |
| initial_wait_time                                | Idle timeout for WAL log reading                                                          | `120`                          | Integer   |
| max_threads                                      | Maximum number of worker threads the connector can spin up for parallel tasks.            | `10`                           | Integer   |
| replication_slot                                 | Slot to retain WAL logs for consistent replication.                                       | `"olake-repl-slot"`            | String    |
| jdbc_url_params                                  | Extra JDBC URL parameters for fine-tuning the connection (left empty if none are needed). | `{"test-param": "test-value"}` | Object    |
| ssl                                              | SSL configuration for the database connection. Contains details such as the SSL mode.     | `{"mode": "disable"}`          | Object    |


    - Similarly `destination.json` file can be created inside this folder, for more information see destination documentaion. <!-- TODO: Destination documentation link must be added here-->

### 2. Verify database connection
    - To verify the `source.json` file this command can be used.

    <Tabs>

    <TabItem value="postgres-cli-docker" label="Using Docker Image" default>
    ```bash title="check command"
    docker run --pull=always \
    -v "[PATH_OF_CONFIG_FOLDER]:/mnt/config" \
    olakego/source-postgres:latest \
    check \
    --config /mnt/config/source.json
    ```
    </TabItem>


    <TabItem value="postgres-cli-binary" label="Using Binary File" default>
    ```bash title="check command"
    [PATH_TO_POSTGRES_BINARY_FILE]/olake check --config [PATH_TO_CONFIG_FOLDER]/source.json
    ```   
 
    </TabItem>

    </Tabs>
    > **Note**: Postgres automatically converts the lowercase username to uppercase, but OLake expects case sensitive credentials.  so if testing the connection fails in OLake try changing the username to all uppercase.
    - If OLake is able to connect with Postgres `{"connectionStatus":{"status":"SUCCEEDED"},"type":"CONNECTION_STATUS"}` response is returned.
   
### 3. Run discover command
The discover command generates a streams.json file containing metadata for all accessible Postgres tables.
    <Tabs>

    <TabItem value="postgres-cli-docker" label="Using Docker Image" default>
    ```bash title="discover command"
    docker run --pull=always \
    -v "[PATH_OF_CONFIG_FOLDER]:/mnt/config" \
    olakego/source-postgres:latest \
    discover \
    --config /mnt/config/source.json
    ```
    </TabItem>


    <TabItem value="postgres-cli-binary" label="Using Binary File" default>
    ```bash title="discover command"
    [PATH_TO_POSTGRES_BINARY_FILE]/olake discover --config [PATH_TO_CONFIG_FOLDER]/source.json
    ```   
 
    </TabItem>

    </Tabs>

        <StreamsConfiguration/>

### 4. Run sync command
Once configuring the `streams.json` file is done. You can start the sync using these commands.
<Tabs>

    <TabItem value="postgres-cli-docker" label="Using Docker Image" default>
    **Sync command**
    ```bash title="sync command"
    docker run --pull=always \
    -v "[PATH_OF_CONFIG_FOLDER]:/mnt/config" \
    olakego/source-postgres:latest \
    sync \
    --config /mnt/config/source.json \
    --catalog /mnt/config/streams.json \
    --destination /mnt/config/destination.json
    ```

    **Sync with state command**
    ```bash title="sync with state command"
    docker run --pull=always \
    -v "[PATH_OF_CONFIG_FOLDER]:/mnt/config" \
    olakego/source-postgres:latest \
    sync \
    --config /mnt/config/source.json \
    --catalog /mnt/config/streams.json \
    --destination /mnt/config/destination.json \
    --state /mnt/config/state.json
    ```
    </TabItem>


    <TabItem value="postgres-cli-binary" label="Using Binary File" default>
    **Sync command**
    ```bash title="sync command"
    [PATH_TO_POSTGRES_BINARY_FILE]/olake sync \
    --config [PATH_TO_CONFIG_FOLDER]/source.json \
    --catalog [PATH_TO_CONFIG_FOLDER]/streams.json \
    --destination [PATH_TO_CONFIG_FOLDER]/destination.json
    ```

    **Sync with state command**
    ```bash title="sync with state command"
    [PATH_TO_POSTGRES_BINARY_FILE]/olake sync \
    --config [PATH_TO_CONFIG_FOLDER]/source.json \
    --catalog [PATH_TO_CONFIG_FOLDER]/streams.json \
    --destination [PATH_TO_CONFIG_FOLDER]/destination.json \
    --state [PATH_TO_CONFIG_FOLDER]/state.json
    ```
    </TabItem>

    </Tabs>

### Postgres to Iceberg Datatype mapping

<PostgresToIcebergDatatypes/>
---

## Troubleshooting
### 1. No encryption (SQLSTATE 28000)
```logs
FATAL failed to ping database: failed to connect to `host=product-team-testing.postgres.database.azure.com user=product_team database=postgres`: server error (FATAL: no p
g_hba.conf entry for host "4.240.65.100", user "product_team", database "postgres", no encryption (SQLSTATE 28000))
```

**Solution**: Change the `ssl.mode`: `disable` to `ssl.mode`: `allow` to resolve this issue. This is a known issue with Azure Postgres and the solution is to set the `ssl.mode` to `allow` in the connection string. 


#### Unexpected EOF
Running Postgres Sync ran into following error: FATAL error occurred while reading records: failed to receive message from wal: receive message failed: unexpected EOF -
**Solution**: Set the value of `initial_wait_time`: 10 in case if you have increased the value in source database config file. This could be because of network issues, try again in that case.


### 2.Connecting to Supbase

OLake can connect seamlessly to [Supabase](https://supabase.com) Postgres databases using any of the three connection modes that Supabase provides:

- **Direct Connection** – Connects directly to the Postgres instance.  
  _Note: By default, Supabase's direct connection supports only **IPv6**. IPv4 support can be enabled via the paid IPv4 add-on._

- **Transaction Pooler** – Uses PgBouncer in transaction pooling mode. Suitable for most use cases that do not require session-level features.

- **Session Pooler** – Recommended when the client network supports only IPv4. In this mode, each client gets a dedicated database session.

> ⚠️ **CDC Support**: The Direct Connection mode is required for CDC (Change Data Capture) operations, as Supabase permits replication slot creation only when connecting directly to the Postgres instance.

#### IP Version Compatibility

OLake fully supports both **IPv4 and IPv6** connections. However, Supabase’s IP compatibility depends on the connection mode and account configuration.

To check your machine or cloud environment’s IP version, you can run:
```bash
curl -6 https://ifconfig.co/ip
```
The format of the returned address indicates the IP version:

- Addresses with four decimal numbers (0–255) separated by dots (.), for eg. `192.168.1.1`, indicate **IPv4**.
- Addresses containing hexadecimal segments separated by colons (:), such as `2404:6800:4007:821::200e`, indicate **IPv6**.

#### Docker IPv6 Support
By default, Docker containers support only IPv4, which may block access to Supabase’s Direct Connection if IPv6 is required. IPv6 can be enabled as follows:

1. Open the **Docker Desktop Dashboard**.
2. Click the **Settings** icon (⚙️) in the top-right corner.
3. Select **Docker Engine** from the left-hand sidebar.
4. In the JSON configuration editor, add the following line

```json
"ipv6":true
```

5. Click Apply & Restart to save the changes and restart Docker.

#### RLS (Row-Level Security) Considerations

When using a read-only database role for syncing with OLake, ensure that **Row-Level Security (RLS)** is either disabled or properly configured. If RLS policies restrict access, sync operations may complete without error but result in **zero rows being replicated**.

To allow a specific role to bypass RLS entirely, execute the following command (replace `<rolename>` with the actual role name):

```sql
ALTER USER <rolename> WITH BYPASSRLS;
```


</TabItem>

</Tabs>